define(["require","app","jquery","../data/getData","./classForm","../common/editPop","formlist","fixedNav","position","../moduls/service","../moduls/factory"],function(require,app,$,getData,list,editPop){app.directive("topicColumnList",function(){return{restrict:"E",replace:!0,transclude:!0,templateUrl:"../template/common/list.html",controller:function($scope,pop,$uibModal,$css,GenerateArrList,$state){$scope.title="系列专题分类列表",$scope.$parent.menu.push({name:$scope.title}),angular.extend($scope,{edit:function(obj){function updateData(callback){GenerateArrList.changeTypeName([obj],[{name:"columnName",newName:"name"}]),callback({data:obj})}editPop.init({obj:obj,list:list,updateData:updateData,save:function(_obj,_detail){getData.topic.updateTopicColumn({id:obj.id,name:_obj.name,callback:function(_data){layui.use(["layer"],function(){var layer=layui.layer;layer.msg(_data.message),setTimeout(function(){$state.reload()},300)})}})},callback:function(list,callback){callback(list)},$uibModal:$uibModal})},del:function(obj){obj.callback=function(_data){layui.use(["layer"],function(){var layer=layui.layer;layer.msg(_data.message),0==_data.code&&$("table").find("tr[data-id="+obj.id+"]").hide()})},pop.alert({text:'您确定要删除"'+obj.columnName+'"吗',btn:["确定","取消"],fn:function(){getData.topic.delTopicColumn(obj)}})}}),getData.topic.topicColumnList({callback:function(_data){var th=[{name:"专题分类名称",key:"columnName"},{name:"操作",width:"120",class:"center"}];$scope.listdata={title:$scope.title,table:{select:!0,th:th,td:GenerateArrList.setArr(_data.data,th),edit:[{cls:"edit",name:"编辑",evt:$scope.edit},{cls:"del",name:"删除",evt:$scope.del}]}},GenerateArrList.extendChild($scope.listdata.table.td,$scope.listdata.table.edit,"edit"),$scope.$apply()}})},link:function($scope,element){}}})});