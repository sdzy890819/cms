define(["app","jquery","./data/getData","./moduls/directive"],function(e,n,t){e.directive("menuNav",function(){return{restrict:"E",replace:!0,transclude:!0,templateUrl:"../template/common/menu.html",compile:function(e,a,r){return{pre:function(e,n,a,r){t.permission.currentMenuPermission({callback:function(n){e.Nav=n.data,e.$apply()}})},post:function(e,t,a,r){e.$on("columnDone",function(){function a(){n("body");var e=document.body.scrollHeight,a=t.find(".menubar").height()+70,r=e-n("#Header").height();a<r?t.height(r):t.height(a)}function r(e){s.parent().removeClass("open").find(".arrow").removeClass("cur"),s.each(function(t){t!=e&&n(this).removeClass("cur").next().slideUp("fast")})}function i(){var e=c.current.name;o.each(function(t){var a=n(this).attr("ui-sref"),r=e.split("."),i=r.length-1,c=n(this).parent();c.removeClass("cur"),a==e&&(n(this).parent().addClass("cur"),n.each(r,function(e){c=c.parent(),e==i&&((c=c.find(">a")).parent().addClass("open").find(".arrow").addClass("cur"),c.next().css({display:"block"}),c[0].parentclas=!1,c.click())}))})}var c=e.state,s=(c.current.name,n(t[0]).find(".option >ul >li >a")),o=n(t[0]).find(".sub-menu a");n(".sub-menu li a").click(function(){var e=n(this).attr("ui-sref"),t=window.location.href.match(/\#[\w|\/]+/);try{(t=(t=t[0].replace("#/","")).replace(/\//g,"."))==e&&location.reload()}catch(e){}}),t=n(t[0]),window.onresize=a,a(),setTimeout(a,1e3),e.menuClick=function(e,t,i){var c=i.currentTarget,s=n(c);r(e),c.parentclas?(c.parentclas=!1,s.parent().removeClass("open"),s.find(".arrow").removeClass("cur"),s.next().slideUp("fast")):(c.parentclas=!0,s.parent().addClass("open"),s.find(".arrow").addClass("cur"),s.next().slideDown("fast")),setTimeout(a,500)},i();var u=t.find(".webapp-tab li"),l=t.find(".option");u.each(function(e,t){n(t).click(function(){u.removeClass("current").eq(e).addClass("current"),l.fadeOut(),l.eq(e).fadeIn()})}),e.$on("$viewContentLoaded",function(){setTimeout(function(){t.css({height:"auto"}),a(),i()},500)}),function(){var e=n(".sidebar-menu"),t=n("#Container"),a=n(".sidebar-menu .jian"),r=!0;a.click(function(){(r=!r)?(a.removeClass("cur").html("&lt;"),e.removeClass("cur"),t.removeClass("cur")):(a.addClass("cur").html("&gt;"),e.addClass("cur"),t.addClass("cur"))})}()})}}},controller:function(e,n){e.state=n}}})});