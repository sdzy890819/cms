define(["app","jquery","form"],function(app,$){return{init:function(obj){var getList=(obj.$uibModal,obj.list);"array"==$.type(getList)&&(getList=function(callback){callback(obj.list)}),obj.$uibModal.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"../template/common/addAndEdit.html",size:obj.obj.size||"lg",controller:function($scope,$uibModalInstance,$css){$scope.data=null,angular.extend($scope,{titelement:{close:!0},save:function(arr){obj.save(arr,$scope.data),$uibModalInstance.dismiss("cancel")},cancel:function(arr){obj.cancel(arr,$scope.data)},close:function(){$uibModalInstance.dismiss("cancel")}}),getList(function(list){obj.callback(list,function(_list){$scope.formdata={title:"编辑",cls:"popedit",list:_list,submit:[{name:"确定",evt:"save",icon_cls:"save"}]},obj.updateData(function(_data){function clear(obj){"selectSize"==obj.type&&(obj.toSelect=[])}$scope.data=_data.data,window.addContent=function(callback){callback(_data.data.newsDetail.content)},_data.data.columnIds&&_data.data.columnIds.length||$.each($scope.formdata.list,function(i,obj){"array"==$.type(obj)?$.each(obj,function(j,_obj){clear(_obj)}):clear(obj)}),$scope.$$phase||$scope.$apply()})})})}})}}});