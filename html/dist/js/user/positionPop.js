define(["app","jquery","../data/getData","../moduls/Tool"],function(app,$,getData,tool){return{init:function(obj){obj.$uibModal;obj.$uibModal.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"../template/template/positionPop.html",controller:function($scope,$state,$uibModalInstance,$css){angular.extend($scope,{titelement:{close:!0},title:"编辑所属用户组",save:function(arr){obj.save(arr,$scope.data)},cancel:function(arr){obj.cancel(arr,$scope.data)},select:function(event){var currentTarget=event.currentTarget;currentTarget.checked?getData.position.setUserPosition({userId:obj.obj.userId,positionId:currentTarget.dataset.id,callback:function(_data){layui.use(["layer"],function(){layui.layer.msg(_data.message)})}}):getData.position.delUserPosition({userId:obj.obj.userId,positionId:currentTarget.dataset.id,callback:function(_data){layui.use(["layer"],function(){layui.layer.msg(_data.message)})}})},close:function(){$uibModalInstance.dismiss("cancel")}});var currentPositionIds=[];getData.position.listUserPosition({userId:obj.obj.userId,callback:function(_data){$.each(_data.data,function(i,o){currentPositionIds.push(o.positionId)}),getData.position.listPosition({callback:function(_data){$.each(_data.data,function(i,obj){obj.ischecked=-1!=$.inArray(obj.id,currentPositionIds)}),$scope.listPositionData=_data.data,$scope.$apply()}})}})}})}}});