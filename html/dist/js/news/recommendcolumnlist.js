define(["app","jquery","require","../data/getData","./recommendcolumnForm","../common/editPop","formlist","position","fixedNav","../moduls/service","../moduls/factory"],function(app,$,require,data,list,editPop){app.directive("recommendcolumnList",function(){return{restrict:"E",replace:!0,transclude:!0,templateUrl:"../template/common/list.html",controller:function($scope,pop,$uibModal,$css,GenerateArrList,$state){function getDataList(){data.news.recommendColumnlist({callback:function(_data){var th=[{name:"id",key:"id",width:"100"},{name:"栏目名称",key:"columnName"},{name:"操作",width:"120",class:"center"}];$scope.listdata={title:$scope.title,table:{select:!0,th:th,td:GenerateArrList.setArr(_data.data,th),edit:[{cls:"edit",name:"编辑",evt:$scope.edit},{cls:"del",name:"删除",evt:$scope.del}]}},GenerateArrList.extendChild($scope.listdata.table.td,$scope.listdata.table.edit,"edit"),$scope.$apply()}})}$scope.title="推荐栏目列表",$scope.$parent.menu.push({name:$scope.title}),angular.extend($scope,{edit:function(obj){function getAddForm(callback){var _data={data:obj};callback(_data)}editPop.init({id:obj.id,obj:obj,list:list,updateData:getAddForm,save:function(obj,_detail){data.news.updateRecommendColumn({id:_detail.id,columnName:obj.columnName,callback:function(_data){layui.use(["layer"],function(){var layer=layui.layer;layer.msg(_data.message),$state.reload()})}})},callback:function(list,callback){callback(list)},$uibModal:$uibModal})},del:function(obj){pop.alert({text:"您确定要删除"+obj.columnName+"吗",btn:["确定","取消"],fn:function(){data.category.delCategory(obj)}}),obj.callback=function(_data){layui.use(["layer"],function(){var layer=layui.layer;layer.msg(_data.message),$state.reload()})}},filter:["id"]}),getDataList()},link:function($scope,element){}}})});