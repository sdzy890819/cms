define(["require","app","jquery","search","./searchForm","./addForm","../common/editPop","../data/getData","../moduls/Tool","formlist","fixedNav","position","../moduls/service","../moduls/factory"],function(t,e,a,i,n,c,r,l,s){e.directive("publishinfoList",function(){return{restrict:"E",replace:!0,transclude:!0,templateUrl:"../template/common/list.html",controller:function(e,i,c,r,s,o,u){function d(t){var i=[{name:"id",key:"id",width:"70"},{name:"触发类型",key:"triggerTypeStr",width:"70"},{name:"触发ID",key:"triggerId",width:"80",class:"center"},{name:"触发的模版",key:"templateTypeStr"},{name:"模版ID",key:"templateId",width:"80",class:"center"},{name:"创建时间",key:"createTimeStr",width:"80",class:"center"},{name:"操作信息",key:"message",width:"160",class:"center"},{name:"操作",width:"40",class:"center"}];e.listdata={title:e.title+"（共"+t.data.page.count+"条数据）",table:{select:!0,th:i,td:s.setArr(t.data.list,i),edit:[{cls:"",name:"查看",evt:e.look}]}},a.each(e.listdata.table.td,function(t,e){e.publish&&(e.list[2].href=e.url)}),s.extendType(e.listdata.table.td,i,["width","name","key"]),s.extendChild(e.listdata.table.td,e.listdata.table.edit,"edit"),e.$apply()}function h(){e.isSearch=!1,l.publishInfo.list({page:p,pageSize:20,callback:function(t){e.page=t.data.page,e.page.jump=function(t){p!=t.curr&&(p=t.curr,h())},d(t)}})}e.title="日志列表",e.$parent.menu.push({name:e.title}),angular.extend(e,{isSearch:!1,getNewList:function(){e.isSearch?e.getSearchList():h()},info:function(t){i.alert({text:"去相关页面，因为还没有页面所以这样提示：<br>ID为："+t.id,btn:["确定","取消"]})},look:function(e){t(["./showDetial"],function(t){e.size="sm",t.init({obj:null,list:function(t){l.publishInfo.detail({id:e.id,callback:function(e){t(e)}})},$uibModal:c})})}}),n(function(t){a.each(t,function(t,e){"select"==e.type&&(e.callback=function(t){})}),e.getSearchList=function(t,a,i,n){l.publishInfo.list({page:t,pageSize:20,status:a,triggerId:i.lastModifyUserName,triggerType:n,callback:function(c){e.page=c.data.page,e.page.jump=function(i){t!=i.curr&&(t=i.curr,e.getSearchList(t,a,i,n))},e.searchform.search={count:c.data.page.count,name:i.condition},d(c)}})},e.searchform={list:t,return:function(){e.searchform.search=null,p=1,searchPage=1,e.$$childHead.current=1,h()},submit:function(t,i){e.isSearch=!0;var n,c;a.each(t.selects,function(){"statusStr"==this.title&&(n=this.type),"triggerTypeStr"==this.title&&(c=this.type)}),e.getSearchList(1,n,t,c)}}});var p=1;h()},link:function(t,e){}}})});