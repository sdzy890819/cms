define(["app","../data/getData","./form","form","position","fixedNav"],function(app,getData,list){app.directive("permissionAdd",function(){return{restrict:"E",replace:!0,transclude:!0,templateUrl:"../template/common/addAndEdit.html",controller:function($scope,$state){$scope.title="新增权限",$scope.$parent.menu.push({name:$scope.title}),$scope.save=function(obj){var type,showFlag,platform;$.each(obj.selects,function(){"type"==this.title&&(type=this.id),"showFlag"==this.title&&(showFlag=this.id),"platform"==this.title&&(platform=this.id)}),getData.permission.createPermission({name:obj.name,description:obj.description,type:type,url:obj.url,sort:obj.sort,parentId:obj.parentId,showFlag:showFlag,platform:platform,permission:obj.permission,callback:function(_data){layui.use(["layer"],function(){layui.layer.msg(_data.message),console.log(_data),0==_data.code&&$state.go("permission.list")})}})},$scope.cancel=function(obj){},$scope.formdata={title:$scope.title,list:list,submit:[{name:"提交",evt:"save",icon_cls:"save"}]}}}})});