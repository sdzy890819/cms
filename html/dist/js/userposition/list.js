define(["require","app","jquery","../data/getData","./form","formlist","fixedNav","position","../moduls/service","../moduls/factory"],function(t,i,e,n,a){i.directive("userpositionList",function(){return{restrict:"E",replace:!0,transclude:!0,templateUrl:"../template/common/list.html",controller:function(i,o,l,s,c,d){function u(){n.position.listPosition({callback:function(t){var e=[{name:"ID",key:"id",width:"200"},{name:"用户组名称",key:"positionName"},{name:"操作",width:"300",class:"center"}];i.listdata={//确认按钮
title:i.title,table:{select:!0,th:e,td:c.setArr(t.data,e),edit:[{cls:"edit",name:"赋予权限",evt:i.editPermission},{cls:"edit",name:"编辑",evt:i.edit},{cls:"del",name:"删除",evt:i.del}]}},
// GenerateArrList.extendType($scope.listdata.table.td,$scope.listdata.table.th,['width','name']); //把TH 中的出name属性以外的属性合传给td
c.extendChild(i.listdata.table.td,i.listdata.table.edit,"edit"),i.$apply()}})}i.title="用户组列表",i.$parent.menu.push({name:i.title}),//栏目
angular.extend(i,{add:function(t){//保存
o.alert({text:"你的ID为："+t,btn:["确定","取消"],fn:function(t){//确定
layer.close(t)}})},edit:function(i){//保存
t(["../common/editPop"],function(t){function e(t){var e={data:i};t(e)}t.init({obj:i,list:a,$uibModal:l,updateData:e,save:function(t,i){n.position.updatePosition({id:i.id,positionName:t.positionName,callback:function(t){layui.use(["layer"],function(){var i=layui.layer;i.msg(t.message),d.reload()})}})},close:function(){l.dismiss("cancel")},callback:function(t,i){i(t)}})})},editPermission:function(i){t(["./permissionsPop"],function(t){t.init({obj:i,$uibModal:l,save:function(t,i){},close:function(){l.dismiss("cancel")},callback:function(t,i){i(t)}})})},del:function(t){o.alert({text:"您确定要删除"+t.positionName+"吗",btn:["确定","取消"],fn:function(){n.position.delPosition(t)}}),t.callback=function(i){layui.use(["layer"],function(){var n=layui.layer;n.msg(i.message),0==i.code&&e("table").find("tr[data-id="+t.id+"]").hide()})}},filter:[//过滤不需要展示的
"id","categoryId"]}),u()},link:function(t,i){}}})});