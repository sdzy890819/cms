define(["require","app","jquery","../data/getData","./form",,"formlist","fixedNav","position","../moduls/service","../moduls/factory"],function(e,a,t,n,l){a.directive("channelList",function(){return{restrict:"E",replace:!0,transclude:!0,templateUrl:"../template/common/list.html",controller:function(a,i,c,d,o,s){a.title="频道列表",a.$parent.menu.push({name:a.title}),angular.extend(a,{add:function(e){i.alert({text:"你的ID为："+e,btn:["确定","取消"],fn:function(e){layer.close(e)}})},edit:function(a){e(["../common/editPop"],function(e){e.init({obj:a,list:l,$uibModal:c,updateData:function(e){e({data:a})},save:function(e,a){var l;t.each(e.selects,function(){"categoryId"==this.title&&(l=this.id)}),n.channel.updateChannel({id:a.id,categoryId:l,channelName:e.channelName,channelUrl:e.channelUrl,channelPath:e.channelPath,templatePath:e.templatePath,channelDesc:e.channelDesc,rsyncModelName:e.rsyncModelName,callback:function(e){layui.use(["layer"],function(){layui.layer.msg(e.message),s.reload()})}})},close:function(){c.dismiss("cancel")},callback:function(e,a){a(e)}})})},del:function(e){i.alert({text:"您确定要删除"+e.channelName+"吗",btn:["确定","取消"],fn:function(){n.channel.delChannel(e)}}),e.callback=function(a){layui.use(["layer"],function(){layui.layer.msg(a.message),0==a.code&&t("table").find("tr[data-id="+e.id+"]").hide()})}}}),n.channel.listChannel({info:1,callback:function(e){var n=[{name:"频道名称",key:"channelName",width:"70"},{name:"频道域名",key:"channelUrl"},{name:"频道绝对路径",key:"channelPath"},{name:"模版位置",key:"templatePath"},{name:"频道说明",key:"channelDesc",width:50},{name:"rsync模块名",key:"rsyncModelName"},{name:"创建人",key:"createUserName",width:60},{name:"创建时间",key:"createTimeStr",width:80},{name:"修改人",key:"lastModifyUserName",width:50},{name:"修改时间",key:"updateTimeStr",width:80},{name:"操作",width:"60",class:"center"}];t.each(e.data,function(e,a){void 0==a.rsyncModelName&&(a.rsyncModelName="")}),a.listdata={title:a.title,table:{select:!0,th:n,td:o.setArr(e.data,n),edit:[{cls:"edit",name:"编辑",evt:a.edit},{cls:"del",name:"删除",evt:a.del}]}},o.extendChild(a.listdata.table.td,a.listdata.table.edit,"edit"),a.$apply()}})},link:function(e,a){}}})});