define(["require","app","jquery","search","./searchForm","./columnForm","../data/getData","../common/editPop","formlist","position","fixedNav","../moduls/service","../moduls/factory"],function(e,t,a,n,i,c,r,l){t.directive("newscolumnManage",function(){return{restrict:"E",replace:!0,transclude:!0,templateUrl:"../template/common/list.html",controller:function(e,t,n,c,l){function o(t){var i=[{name:"ID",key:"id",width:"50"},{name:"栏目名",key:"columnName"},{name:"频道ID",key:"channelId",width:"50"},{name:"频道名称",key:"channelName"},{name:"创建人",key:"createUserName",width:60},{name:"创建时间",key:"createTimeStr",width:80},{name:"修改人",key:"lastModifyUserName",width:60},{name:"修改时间",key:"updateTimeStr",width:80},{name:"操作",width:150,class:"center"}];e.listdata={title:e.title,table:{select:!0,th:i,td:n.setArr(t.data.list,i),edit:[{cls:"edit",name:"恢复",evt:e.recovery}]}},a.each(e.listdata.table.td,function(e,t){t.listUrl&&(t.list[1].href=t.listUrl)}),n.extendChild(e.listdata.table.td,e.listdata.table.edit,"edit"),e.$apply()}function u(){e.isSearch=!1,r.news.newscolumn_manage({page:s,pageSize:20,callback:function(t){e.page=t.data.page,e.page.jump=function(e){s!=e.curr&&(s=e.curr,u())},o(t)}})}e.title="新闻栏目删除列表",e.$parent.menu.push({name:e.title}),angular.extend(e,{recovery:function(e){e.callback=function(t){layui.use(["layer"],function(){layui.layer.msg(t.message),0==t.code&&a("table").find("tr[data-id="+e.id+"]").hide()})},t.alert({text:'您确定要恢复"'+e.columnName+'"吗',btn:["确定","取消"],fn:function(){r.news.newscolumn_recover(e)}})}}),i(function(t){e.searchform={list:t,return:function(){e.searchform.search=null,s=1,searchPage=1,e.$$childHead.current=1,u()},submit:function(t,n){function i(){r.news.newscolumn_manage({channelId:c,page:l,pageSize:20,callback:function(a){e.page=a.data.page,e.page.jump=function(e){l!=e.curr&&(l=e.curr,i())},e.searchform.search={count:a.data.page.count,name:t.condition},o(a)}})}e.isSearch=!0;var c,l=1;a.each(t.selects,function(){"channelId"==this.title&&(c=this.id)}),i(),e.getSearchList=i}},setTimeout(function(){var e=a('.layui-form input[name="condition"');a("<br>").insertBefore(e.parent().parent())},300)});var s=1;u()},link:function(e,t){}}})});