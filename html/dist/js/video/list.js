define(["require","app","jquery","../data/getData","./addForm","search","./searchForm","formlist","fixedNav","position","../moduls/service","../moduls/factory"],function(e,t,a,i,n,c,l){t.directive("videoList",function(){return{restrict:"E",replace:!0,transclude:!0,templateUrl:"../template/common/list.html",controller:function(t,c,d,r,o){function u(e){var a=[{name:"ID",key:"id",width:"50"},{name:"视频标题",key:"videoTitle",width:180},{name:"视频链接URL",key:"videoUrl"},{name:"创建人",key:"createUserName",width:60},{name:"创建时间",key:"createTimeStr",width:80},{name:"修改人",key:"lastModifyUserName",width:60},{name:"修改时间",key:"updateTimeStr",width:80},{name:"m3u8Url",key:"m3u8Url",width:80},{name:"操作",width:"120",class:"center"}];t.listdata={title:t.title,table:{select:!0,th:a,td:o.setArr(e.data.list,a),edit:[{cls:"edit",name:"编辑",evt:t.edit},{cls:"del",name:"删除",evt:t.del}]}},o.extendChild(t.listdata.table.td,t.listdata.table.edit,"edit"),t.$apply()}function s(){t.isSearch=!1,i.video.videolist({page:f,pageSize:20,callback:function(e){t.page=e.data.page,t.page.jump=function(e){f!=e.curr&&(f=e.curr,s())},u(e)}})}t.title="视频管理",t.$parent.menu.push({name:t.title}),angular.extend(t,{isSearch:!1,getNewList:function(){t.isSearch?t.getSearchList():s()},add:function(e){c.alert({text:"你的ID为："+e,btn:["确定","取消"],fn:function(e){layer.close(e),t.getNewList()}})},edit:function(t){e(["./editVideoPop"],function(e){e.init({obj:t,list:n,$uibModal:d,updateData:function(e){e({data:t})},callback:function(e,t){t(e)}})})},del:function(e){layui.use(["layer"],function(){var t=layui.layer;t.alert("你确定删除："+e.videoTitle,{skin:"layui-layer-molv newBtn",title:"删除",anim:1,btn:["普通删除","物理删除","取消"],shadeClose:!0,yes:function(a){i.video.delVideo(e),t.close(a)},btn2:function(a){i.video.delVideo({id:e.id,force:1,callback:e.callback}),t.close(a)}})}),e.callback=function(t){layui.use(["layer"],function(){layui.layer.msg(t.message),0==t.code&&a("table").find("tr[data-id="+e.id+"]").hide()})}},filter:["id","uploadUserId"]});var f=1;s(),function(){var e=1;l(function(a){t.searchform={list:a,return:function(){t.searchform.search=null,f=1,e=1,t.$$childHead.current=1,s()},submit:function(a,n){function c(){i.search.searchVideo({condition:a.condition,page:e,pageSize:20,callback:function(i){t.page=i.data.page,t.page.jump=function(t){e!=t.curr&&(e=t.curr,c())},t.searchform.search={count:i.data.page.count,name:a.condition},u(i)}})}t.isSearch=!0,c(),t.getSearchList=c}},t.$$phase||t.$apply()})}()},link:function(e,t){}}})});