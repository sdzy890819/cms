<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"><html><head><title>完整demo</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8"><script charset="utf-8" src="ueditor.config.js"></script><script charset="utf-8" src="ueditor.all.min.js"></script><script charset="utf-8" src="lang/zh-cn/zh-cn.js"></script><script charset="utf-8" src="third-party/jquery-1.10.2.min.js"></script><style>div{width:100%}</style></head><body><div><script id="editor" type="text/plain" style="width:100%"></script></div><script>function getContent(){var t=editor.getContent();return t}function insertHtml(t){editor.addListener("ready",function(){editor.execCommand("insertHtml",t)})}var editor=UE.getEditor("editor");editor.addListener("ready",function(){var t=document.getElementById("edui1_toolbarbox").offsetHeight+50;editor.setHeight(window.top.document.getElementById("editor").contentWindow.frameElement.scrollHeight-t);var e=window.clipboardData,n="";e&&(n=e.getData("Text")),window.parent.addContent?window.parent.addContent(function(t){editor.execCommand("insertHtml",t)}):editor.execCommand("insertHtml",n)}),UE.registerUI("button",function(t,e){t.registerCommand(e,{execCommand:function(){}});var n=$('<div style="position:fixed; padding:10px 20px; width:200px; border:1px solid #ccc; background:#fff; z-index:999;"><input style="width:150px;" type="text" placeholder="代码 / 简称 / 拼音"/></div>'),o=!1,i=new UE.ui.Button({name:e,title:e,cssRules:"background-position: -420px -20px;",onclick:function(i){function d(e){var n=this,o=n.offset(),i=o.left,d=o.top-$("body").scrollTop()+n.height()+20;if(r.css({left:i+"px",top:d+"px"}).show(),e.length){var a="";s.html(""),$.each(e,function(e,n){a=$("<tr><td style='padding:5px 0;'>"+n.s1+"</td><td>"+n.s3+"</td></tr>"),a.mouseover(function(){$(this).css({background:"#f8f8f8"})}).mouseleave(function(){$(this).css({background:"#fff"})}),a.click(function(e){var o="<a style='color:red' stkcode='"+n.s1+","+n.s3+"' href='http://data.p5w.net/stock/index.php?code="+n.s2+n.s1+"'>"+n.s3+"("+n.s1+")</a>";t.execCommand("insertHtml",o),r.hide()}),s.append(a)})}}var a=$(this.target);n.css({left:a.offset().left-100,top:a.offset().top+a.height()});var r=$("<div id='stock-pop' style='border:1px solid #ccc; padding:5px; font-size:12px; text-align:center; color:#666; background:#fff; left:0; top:0; display:none;'><table width='100%' cellspacing='0' cellpadding='0'><thead><tr><th>代码</th><th>名称</th></tr></thead><tbody></tbody></table></div>"),s=r.find("tbody");r.appendTo(n),n.appendTo($("body")),n.mouseover(function(){o=!0}).mouseleave(function(){o&&(n.remove(),r.remove(),o=!1)}),t.execCommand(e);var c=0;n.bind("input propertychange",function(t){var e=$(this).find("input"),n=e.val();clearTimeout(c),c=setTimeout(function(){$.ajax({url:"http://hq.p5w.net/hq/suggestion.php",data:{query:n},type:"get",dataType:"jsonp",success:function(t){d.call(e,t)}})},300)})}});return t.addListener("selectionchange",function(){var n=t.queryCommandState(e);n==-1?(i.setDisabled(!0),i.setChecked(!1)):i.setDisabled(!1)}),i})</script></body></html>